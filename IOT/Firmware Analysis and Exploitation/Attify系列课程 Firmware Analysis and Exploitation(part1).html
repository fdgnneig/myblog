<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta content="text/css" http-equiv="Content-Style-Type">
<title>Attify系列课程&#13;
Firmware Analysis and Exploitation(part1)</title>
</head>
<body>
<h1 align="center" class="root">
<a name="39lj2hrv4i08kfq3067l7nb9gq">Attify系列课程&#13;
Firmware Analysis and Exploitation(part1)</a>
</h1>
<div align="center" class="globalOverview">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/images/Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1).jpg"></div>
<h2 class="topic">
<a name="7dopcuhgq8aldp8rnfs5cemi6a">intro to firmware</a>
</h2>
<h3 class="topic">
<a name="5060276hlais1bd0p15co7vfu3">&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/5jin6kr5ani5uthjpf0a85ujcm.png"></p>
<h3 class="topic">
<a name="7a5dcajcvq232tp00une91066k">&nbsp;&nbsp;glitching attack是指进行噪音攻击，从而使bootloader不释放内核，从而进入bootloader命令行</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0qkfhemmdgped6rdd756id7pdf.png"></p>
<h3 class="topic">
<a name="6nlimi0d5vgcmdr4pko3t7o70k">&nbsp;&nbsp;&nbsp;linux启动过程</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0ckajsb41qrod868hbkntetbsh.png"></p>
<h3 class="topic">
<a name="2sgg3ma4gv2rrrqq45bbiq3a3l">&nbsp;&nbsp;&nbsp;&nbsp;关于bootloader</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/3apfa8vr7vt35gblca52usn704.png"></p>
<h3 class="topic">
<a name="2r5lkufrnihsbpjp9tl5581atv">&nbsp;常见bootloader类型，注意CFE也是一种bootloader</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4u8756k8al1j6ktleb4nrqnq9o.png"></p>
<h3 class="topic">
<a name="5hv2ganilc5c99ccoqle7607pi">&nbsp;&nbsp;bootloader提供的指令，关键在于可以使用setenv指令修改bootargs参数，从而修改bootloader启动参数，从而启动自己想要启动的模式</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/1uvkqo7al5al37mqpkm78a3qkq.png"></p>
<h3 class="topic">
<a name="5o2t3c45dimo1n7itc3m8v5c66">&nbsp;&nbsp;&nbsp;所示，该串口调试界面需要用户名密码登陆才能使用</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0dhmbm57dsk2i0j7a92jh6dl5g.png"></p>
<h3 class="topic">
<a name="0mjrekc7tp7g2bmb7ioi08c6ge">&nbsp;&nbsp;&nbsp;&nbsp;给bootargs选项添加single选项，从而让bootloader引导系统启动为单用户模式，从而绕过用户名密码验证</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0ib791c5c21bo6mfd12iav77ht.png"></p>
<h3 class="topic">
<a name="0gmevdkp5v9i71p9goc2ooscpq">&nbsp;下次重启时，直接进入单用户模式，无需验证</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0o57a3ab678b4bi2tdab29enb4.png"></p>
<h3 class="topic">
<a name="0qoqonrd2n7na9904gnjdmp6ik">&nbsp;&nbsp;工具链：可能是原生的或交叉编译的，包括bin工具，gcc、c库文件、gdb调试</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/24hta17903ri7i0qqd4acvmc78.png"></p>
<h3 class="topic">
<a name="7c1lv1683bscolufgiqvrm47dj">&nbsp;&nbsp;&nbsp;c库的选择可以是libc或其他几种c运行库</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/7ru3bngvh1d8b0pp55c1u26i18.png"></p>
<h3 class="topic">
<a name="72qfseomosklo0stfpg1gdj3c5">&nbsp;&nbsp;&nbsp;&nbsp;busybox，可以进行裁剪从而适用于不同的嵌入式设备</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/2ej5iu0fdpufjhf63bkruhthlv.png"></p>
<h3 class="topic">
<a name="5p8aqp1fmijr3pt19hmakh3bai">&nbsp;固件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/6fmtbqkrsshf0658spe5v0n9ef.png"></p>
<h3 class="topic">
<a name="52mlg2almm9tn5oueg10bq0r1n">&nbsp;&nbsp;后门寻找中可以关注硬编码信息、password、登陆url、API密钥</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/6i819fhvg7rov515p308dnneig.png"></p>
<h3 class="topic">
<a name="24ontjcmbtv9if3fkdetskcll7">&nbsp;&nbsp;&nbsp;获取固件（OTA是指更新机制），逆向app可能发现固件的下载url，app通过wifi等网络机制下载固件，然后通过蓝牙等连接方式连接设备，从而更新固件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/00fvfuporffo9cd9ao2gf85ak6.png"></p>
<h3 class="topic">
<a name="0omp8c33r950528ehu5v8ap7tr">&nbsp;&nbsp;&nbsp;&nbsp;固件漏洞分析</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/1li0djuf44us9oonkce21jd106.png"></p>
<h3 class="topic">
<a name="6uev9hmpaqbavfkrjrm6pflu7o">&nbsp;分析固件二进制程序，使用strings命令+hexdump命令分析二进制文件中的字符串</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/5cmngupri4icsocveemktf3usl.png"></p>
<h3 class="topic">
<a name="3ncqdhih2fu5tfij47pksu24ii">&nbsp;&nbsp;固件的内部组成</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/62n6caqtiur5fd3aolo26jjrr1.png"></p>
<h3 class="topic">
<a name="5pm7pbmc0ukrok3m0pqiarn5d2">&nbsp;&nbsp;&nbsp;常见的文件系统类型，文件系统可能是以压缩形式存储在固件中，用到哪部分，解压哪部分</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/63n7o06d8sv103rror28eea64o.png"></p>
<h3 class="topic">
<a name="1aonsckqpajvfs009tro3or3lh">&nbsp;&nbsp;&nbsp;&nbsp;常见文件系统压缩格式</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/15d0dpmv0dgcqhgeae1ti92de0.png"></p>
<h3 class="topic">
<a name="7dn03v3g61o7n6udj1227o97ha">&nbsp;总结：固件提取后，关键在于识别文件系统并提取文件系统并解压缩</a>
</h3>
<h2 class="topic">
<a name="5to1uaa2k2opnjtj3j8nr36c0p">extracting file system from firmware</a>
</h2>
<h3 class="topic">
<a name="14rf3m910tlb9pi03u6dhc8n8l">&nbsp;将下载得到的固件解压到特定目录</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/55i6c3tmf6fubb9egsoskiaqir.png"></p>
<h3 class="topic">
<a name="5j016oo2vrt3bqtnspedj6l6sf">&nbsp;&nbsp;通过file命令得到固件相关信息</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0bieo9mpuo9qnk4h398ljuamo6.png"></p>
<h3 class="topic">
<a name="00rmb5g3o728upl6prc5d8k91m">&nbsp;&nbsp;&nbsp;使用string命令（在对象文件或二进制文件中查找可打印的字符串），head命令过滤输出的前100行，指定文件中，查看文件中内容，未发现有用字符串</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/3r7j52a99adl36175c6u4acntq.png"></p>
<h3 class="topic">
<a name="4jiltgsv8uc8ob8njopdrlarr0">&nbsp;&nbsp;&nbsp;&nbsp;hexdump -C参数可以以hex+ascii形式输出二进制文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4p0tlvo7ld12k0dr5l7kf8qb33.png"></p>
<h3 class="topic">
<a name="23b34ecj4628kejnt8jer1ftaa">&nbsp;hexdmp -C参数查找文件系统魔数，从而定位文件系统在固件中的位置，该文件系统为SquashFS文件系统</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/685r7bqp8jrgqr5h26t70un9ed.png"></p>
<h3 class="topic">
<a name="4guric45hqssba1ot546v77qbk">&nbsp;&nbsp;dd命令，将文件系统从固件中截取出来，截取位置是从文件系统起始到固件结束</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/17cou2thofdgn51odqrrs04ubh.png"></p>
<h3 class="topic">
<a name="46iqe6au2diek9ajudt76sp2v3">&nbsp;&nbsp;&nbsp;使用unsquashfs命令解压文件系统</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/289pl27bthm2jr9mbresckbjlk.png"></p>
<h3 class="topic">
<a name="1ccfi4bifl6157h6tn8hbo7ctb">&nbsp;&nbsp;&nbsp;&nbsp;得到文件系统</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4727b2rlshvupteogmqphenlqk.png"></p>
<h3 class="topic">
<a name="7mn517g1bjgnp0gt9pijo45lr0">&nbsp;进入www目录可以得到web目录相关数据</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/6meaj60e3ntec45pet1cf78klv.png"></p>
<h3 class="topic">
<a name="1tvp4sh0oei24t17dl9c5uhf88">&nbsp;&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/1raukuuv5m3v7p97fn0emc0r6s.png"></p>
<h3 class="topic">
<a name="3stgtm8qc9v6taq0unsdjc8ho8">&nbsp;&nbsp;&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/1506gmc0mrg4m315ggvsfa7teb.png"></p>
<h3 class="topic">
<a name="5nulq3rv7p06gmsdddt2kubuom">&nbsp;&nbsp;&nbsp;&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/55bo2k5rihtkuvi83jbdaq7ec9.png"></p>
<h2 class="topic">
<a name="7j6hga0vep9o8sa5pnk0lfk7uk">自动提取文件系统 by binwalk</a>
</h2>
<h3 class="topic">
<a name="3r1gfs0jce01n40gu7omtes0g5">&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/1131ki1edcbndc25hk2076o01h.png"></p>
<h3 class="topic">
<a name="1v6hcm704jh4bngfl9eq6373vm">&nbsp;&nbsp;查看binwalk保存文件系统魔数的文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/5ej1amnvjcs9dfashg8imsfd35.png"></p>
<h3 class="topic">
<a name="2e9reel5lhpg13tjcgl8pgne69">&nbsp;&nbsp;&nbsp;文件中squash文件系统的魔数</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4u1orhl9kfu4umn4drihnvi17p.png"></p>
<h3 class="topic">
<a name="4q6u9b6u56o1tvnme0b4cqo9f4">&nbsp;binwalk用法</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/7m5e34bdtoenu74nr08u7g4pmb.png"></p>
<h3 class="topic">
<a name="35c44oobcnf97tjaukcjt7th8d">&nbsp;&nbsp;binwalk -e解压后，得到两个区段，其一为LZMA压缩数据段，其二为squashfs文件系统</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/6q0fs2qgv4761aoknin0qi8iag.png"></p>
<h3 class="topic">
<a name="4227efdut3k24hn98c5li7qunv">&nbsp;&nbsp;&nbsp;查看你binwalk提取结果</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/3p2jmtev6hdql2lrejlvup9p01.png"></p>
<h2 class="topic">
<a name="5hefra2rte7s41r8q8hgfdj1qq">固件中隐藏的证书（即查找固件中隐藏的敏感信息）</a>
</h2>
<h3 class="topic">
<a name="679sfl53md5f9d4hcicl6v2v88">&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/76egmcc2burbrnt4u2q2ogjum7.png"></p>
<h3 class="topic">
<a name="6o5qiret6qvoi7nkhj4bespe4m">&nbsp;&nbsp;file指令分析固件有时得不到结果</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/7hdbk8mmmpht8a9a7ovsu4ab72.png"></p>
<h3 class="topic">
<a name="1v0tfn78r1j18hdrg1rubb7d18">&nbsp;&nbsp;&nbsp;binwalk解包，输出信息中仅识别出一个gzip压缩文件，位于0x30处，binwalk提取结果中页仅得到一个文件30，即输出信息中标识的0x30处的gzip文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/1qfsi25oqh0m3rmblhbuqo79tl.png"></p>
<h3 class="topic">
<a name="12pis35krmvrb0jjchgs3qpflu">&nbsp;&nbsp;&nbsp;&nbsp;查看文件类型为压缩文件，使用tar命令解压缩</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/2osnn1mvg3f2qbj6k7ichmprok.png"></p>
<h3 class="topic">
<a name="3b32e4l95r5mf59c4vqlevdjl8">&nbsp;解压得到wnc</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/15idotocp0tojmfg6jmfjco6lj.png"></p>
<h3 class="topic">
<a name="3v44m6s5ta71f6cs4ilg0qf79a">&nbsp;&nbsp;得到文件系统，查看etc目录</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/2pk95dd28d7v0e9oduiljpur23.png"></p>
<h3 class="topic">
<a name="3rltgigj0003554nblgfvtcaca">&nbsp;&nbsp;&nbsp;查看配置文件，发现RSA私钥敏感信息</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/6s7sdnk9o7u49d10j0d0crksvq.png"></p>
<h3 class="topic">
<a name="00jt78g00brl0l0025igfjjt3l">&nbsp;&nbsp;&nbsp;&nbsp;总结，同样的方法可以用于寻找API密钥，后台url，ssh telnet的登陆凭证</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/2mugli8r0vko2ptcaj1pmcvpda.png"></p>
<h2 class="topic">
<a name="316c90u2lbih0av476iebhq974">固件中硬编码的telnet证书信息</a>
</h2>
<h3 class="topic">
<a name="6t30bvhh954bq4av1522kkokdi">&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/5dj3l5n73so4hqovi52aq7pg6k.png"></p>
<h3 class="topic">
<a name="6sdfdulshe7u887qion4m9b6uf">&nbsp;&nbsp;解包固件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/2jmt6m7sf6nnc0b43ahsi58qrm.png"></p>
<h3 class="topic">
<a name="27b1g7hl8qvkt1439i3nalg8su">&nbsp;&nbsp;&nbsp;解包得到如下几个部分的数据，从输出信息中可以看出mips等架构信息</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/17e6b3q4rjevperjhcqkaja1gl.png"></p>
<h3 class="topic">
<a name="7d4pbe37qvijgblip15u5bd7au">&nbsp;&nbsp;&nbsp;&nbsp;得到固件系统，进入etc目录下寻找敏感信息</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0nqouqknkumjod8407rhc9jdu0.png"></p>
<h3 class="topic">
<a name="79bh8je3rs0knaahj41cetkumr">&nbsp;查看init.d目录，查看初始化信息</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0ou558fe6687jce9hb9utk6uu6.png"></p>
<h3 class="topic">
<a name="7bsrpuk0jnbdqu6sumr8b8cdja">&nbsp;&nbsp;查看rcS文件内容</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/3au9oljigujc3n95gdhf9s3uc8.png"></p>
<h3 class="topic">
<a name="6olt3tp4f9remccl3j3u2a1jme">&nbsp;&nbsp;&nbsp;rcS脚本可以看出，该脚本会执行同目录下所有S开头的脚本文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/704eea3bn8sv5i3s841pnjqalu.png"></p>
<h3 class="topic">
<a name="7jpooq3rmsagkfqon58t5a24ak">&nbsp;&nbsp;&nbsp;&nbsp;同目录三个S开头的脚本实际上软链接到etc目录下其他脚本中，故可以查看此类脚本</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/1nc6hgb5r2hfe8nv8arjp247sh.png"></p>
<h3 class="topic">
<a name="1fli228j9islughkptohr5o8bu">&nbsp;用grep -iRn参数过滤当前目录下所有脚本中的telnt字段&#13;
-i --ignore-case    # 忽略字符大小写的差别。&#13;
-R/-r  --recursive       # 此参数的效果和指定&ldquo;-d recurse&rdquo;参数相同。&#13;
-d&lt;进行动作&gt; --directories=&lt;动作&gt;  # 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep命令将回报信息并停止动作。&#13;
-n --line-number         # 在显示符合范本样式的那一列之前，标示出该列的编号。&#13;
根据输出，通过telnetd.sh脚本，启动了telnet</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/18kgs9thtgtt7d09hs3ct0l4j8.png"></p>
<h3 class="topic">
<a name="5hgtmgt1065ivkvpabnnos05gt">&nbsp;&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0j7l43bh754f87kguoo0av21p2.png"></p>
<h3 class="topic">
<a name="2ln00a2813bpbdsnvcbcq03n74">&nbsp;&nbsp;&nbsp;打开image_sign文件，查看到telnet密码</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/793btt3k4trm9e7bqu92slb1cu.png"></p>
<h2 class="topic">
<a name="4jmd9mhnrd3kqauchrvjmsndgj">破解有密码保护的固件并查找敏感固件</a>
</h2>
<h3 class="topic">
<a name="123jd600db9u7vg2f8as3r5dct">&nbsp;使用fcrackzip工具破解压缩包密码</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/392986gobfbme1i3ufjha5h0ts.png"></p>
<h3 class="topic">
<a name="13okc17k7q6c5c5gfh632q24rt">&nbsp;&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/3gh9pj3srbkb32357lb52bb3k6.png"></p>
<h3 class="topic">
<a name="12clabf90cpov2nccck33aipva">&nbsp;&nbsp;&nbsp;即使没有密码 unzip命令也可以输出一些有用的信息，例如文件系统格式</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/3h18t62pjeufnm941eipp7b000.png"></p>
<h3 class="topic">
<a name="4mnurn6fgigo09lde5pod99vsv">&nbsp;&nbsp;&nbsp;&nbsp;安装zip密码破解工具</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4pfmd6mun53bfd3q4hkb31q1eu.png"></p>
<h3 class="topic">
<a name="3ipapttktjmecmhlakhc82lrlg">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看fcrackzip命令解释</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/429qgatgmhd3lfk6m41j960cpe.png"></p>
<h3 class="topic">
<a name="6pn71aul0s593iasic1qh1kqcc">&nbsp;尝试破解zip密码，返回错误信息，该文件不是有效的zip文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/62d1usp244p3pmjmvtg7e1t83g.png"></p>
<h3 class="topic">
<a name="5dgag20nphc7ou5ba2nfsg0kip">&nbsp;&nbsp;将加密的zip文件十六进制方式显示，less命令通过分屏上下翻页浏览文件内容</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4p9b5ats0414ar6nmicohq8enc.png"></p>
<h3 class="topic">
<a name="26i86bqglqnv1d005mdvbvodtj">&nbsp;&nbsp;&nbsp;0x50 0x4b为zip文件头魔数，输出内容中文件头魔数前面还有数据，所以fcrackzip未成功识别zip文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/6nlsd6091dcggp57eaj6l01d6l.png"></p>
<h3 class="topic">
<a name="01gq06v7blb577ahanekbofkr2">&nbsp;&nbsp;&nbsp;&nbsp;通过多个命令结合输出文件中第一个PK字符所在的偏移为0x40，即10进制的64</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/434kt1uot6ec76fbp3fmivgbll.png"></p>
<h3 class="topic">
<a name="0o5p8ug7qg2ts7io0c0u6k54vp">&nbsp;使用dd命令截取文件64字节之后的数据，截取之后的文件为有效的zip文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/2m8kh25g9rla6qcsuuvqbft9eb.png"></p>
<h3 class="topic">
<a name="23j3un47kjv65kesi97qq8jam8">&nbsp;&nbsp;使用hexdump查看，发现文件头的确为PK</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/2l5hmnd3nass09pj6bmqt0jl1u.png"></p>
<h3 class="topic">
<a name="0505a8lvb1eam2qnkkom38kq2u">&nbsp;&nbsp;&nbsp;此时再使用fcrackzip进行zip密码破解。即可破解成功</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/10gort76id4u4t5v1m03qm6fes.png"></p>
<h3 class="topic">
<a name="5sejki8kdu2uqckmvah6h49g74">&nbsp;&nbsp;&nbsp;&nbsp;使用破解得到的密码将zip文件解压到指定目录中</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0top9rd4dsp93ktafloh69k3f9.png"></p>
<h3 class="topic">
<a name="0qjd620b4edkrk0ood99elro00">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;识别并提取文件系统</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/69qmdbtfcf1sf2j442ii1dl3k7.png"></p>
<h3 class="topic">
<a name="1gg2gv36osn0sdtl35dqvd7e8g">&nbsp;进入提取的文件系统</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/55vpv8382n691uj66n4i2jdg8l.png"></p>
<h3 class="topic">
<a name="225i6ea59tufc9vsn091gmvvjo">&nbsp;&nbsp;find命令列出所有配置文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/2enf0hujj88rekp3mlabbfo5e7.png"></p>
<h3 class="topic">
<a name="46bs011dq0kt9j9p085oqcn7r1">&nbsp;&nbsp;&nbsp;查看wpa相关配置文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0nvo0ln4a4mkv0ejov4c1rlbt0.png"></p>
<h3 class="topic">
<a name="23a7k7ls30kbdg0bgvbb3a4psh">&nbsp;&nbsp;&nbsp;&nbsp;查看到密码相关信息</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/54364nj08d7s409fgunfbb52gi.png"></p>
<h3 class="topic">
<a name="0qs8uktsgn9fb79u1aikg0s5in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看另一个配置文件，发现用户名和密码</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/3tj11r5v7ft3lft0r4fk4utqa2.png"></p>
<h2 class="topic">
<a name="7u9mitb071ov7tt6leb5ug6jng">使用Hopper逆向二进制程序</a>
</h2>
<h3 class="topic">
<a name="3ctkc2tqq1f6p6enk3fmh8e701">&nbsp;固件文件系统切换到bin目录</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/43ab1kfqdlfssn733rejc7p714.png"></p>
<h3 class="topic">
<a name="4km24pj360vhudunibjhamhet7">&nbsp;&nbsp;查看bin目录中文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0metlnh2014vmkrd42frn5kquf.png"></p>
<h3 class="topic">
<a name="21kb8hhrtd7sr28l5qfjbhijhm">&nbsp;&nbsp;&nbsp;查看appmgr程序信息</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/16vndp78qseopdtnmgj9ark7rc.png"></p>
<h3 class="topic">
<a name="65mtpv1v1v1vuakcm6ffr01fa0">&nbsp;&nbsp;&nbsp;&nbsp;输出appmgr文件中可以打印的字符</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4drpglufn6udf34ns077fmhi17.png"></p>
<h3 class="topic">
<a name="5k5c8bngncqlf94qr64mgpsvj0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用nano查看dump文件</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/7c3697i0gqj0127pkd95sum1q6.png"></p>
<h3 class="topic">
<a name="71vdgfvsh55q63krdeudontf38">&nbsp;</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/66l7hvh3h0nfdjupjf3km3dvdq.png"></p>
<h3 class="topic">
<a name="318kfkmvhbcoojvtsdtp048rnb">&nbsp;&nbsp;使用hopper反编译工具打开appmgr工具</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/706f2u7gsc0is573v0b10l305k.png"></p>
<h3 class="topic">
<a name="4big4hl5or212nrqk7lgijo446">&nbsp;&nbsp;&nbsp;在hopper中选中字符串搜索，找到字符串后按x可以搜索对该字符串的引用</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4cnfteonro3ksoutne07m3lpn2.png"></p>
<h3 class="topic">
<a name="39pksqts4a9t2rkqr8ofud9h6o">&nbsp;&nbsp;&nbsp;&nbsp;字符串上按x找到字符串的交叉引用</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/0d6j4cllve574fe1nvt0evb8fp.png"></p>
<h3 class="topic">
<a name="2v8hloh7spvn76vf22ch1p7c65">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交叉引用中找到伪代码模式，相当于IDA的f5</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/4fgb71bijho2tb0qrc6hg85opm.png"></p>
<h3 class="topic">
<a name="7rgs6r0rlocm6cr7n5sco037e5">&nbsp;伪代码中搜索telnet，发现相关指令</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/441d9duejcmro8p0nvu6n5khl3.png"></p>
<h3 class="topic">
<a name="7nqbq6s3jfbn2jpt9k286h29c5">&nbsp;&nbsp;分析指令，发现后门代码</a>
</h3>
<p class="topicImage">
<img src="Attify%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B Firmware Analysis and Exploitation(part1)_files/76h7rsn75tc1tqq55kdf919ifm.png"></p>
</body>
</html>
